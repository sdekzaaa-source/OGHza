<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ROC GGT: Chrono Pass Diary</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;700&family=Rajdhani:wght@600;700&display=swap" rel="stylesheet">
    <style>
        :root { --roc-red: #e11d48; --roc-gold: #f59e0b; }
        body { font-family: 'Kanit', sans-serif; background-color: #f1f5f9; color: #334155; }
        .font-gaming { font-family: 'Rajdhani', sans-serif; }
        .game-card { background: white; border-radius: 20px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05); border: 1px solid #e2e8f0; overflow: hidden; }
        .pkg-btn { border: 2px solid #e2e8f0; cursor: pointer; transition: all 0.2s; position: relative; }
        .pkg-btn.active { border-color: var(--roc-red); background-color: #fff1f2; }
        .btn-roc { background: linear-gradient(180deg, #ef4444 0%, #b91c1c 100%); color: white; box-shadow: 0 4px 0 #7f1d1d; transition: all 0.1s; }
        .btn-roc:active { transform: translateY(2px); box-shadow: 0 1px 0 #7f1d1d; }
        .custom-scroll::-webkit-scrollbar { width: 4px; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
        .quest-step { position: relative; padding-left: 30px; }
        .quest-step::before { content: ''; position: absolute; left: 10px; top: 0; bottom: 0; width: 2px; background: #e2e8f0; }
        .quest-step:last-child::before { display: none; }
        .step-bullet { position: absolute; left: 0; top: 0; width: 22px; height: 22px; border-radius: 50%; background: white; border: 2px solid #cbd5e1; z-index: 10; display: flex; align-items: center; justify-content: center; font-size: 10px; font-weight: bold; }
        .step-active .step-bullet { border-color: #ef4444; color: #ef4444; box-shadow: 0 0 8px rgba(239, 68, 68, 0.2); }
        .step-done .step-bullet { background: #ef4444; border-color: #ef4444; color: white; }
    </style>
</head>
<body class="pb-10">

    <nav class="bg-white border-b border-slate-200 sticky top-0 z-50 p-4 shadow-sm">
        <div class="max-w-6xl mx-auto flex justify-between items-center">
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 bg-red-600 rounded-xl flex items-center justify-center text-white font-gaming text-xs font-bold leading-tight text-center shadow-lg">ROC<br>GGT</div>
                <h1 class="font-gaming text-xl font-bold tracking-tight text-slate-800 uppercase">Chrono Pass <span class="text-red-600">Diary</span></h1>
            </div>
            <button onclick="resetData()" class="text-[10px] font-bold text-slate-400 border border-slate-200 px-3 py-1.5 rounded-lg hover:bg-slate-50 transition">RESET ALL</button>
        </div>
    </nav>

    <main class="max-w-6xl mx-auto p-4 space-y-6">
        
        <!-- PACKAGE SELECTION -->
        <section class="game-card p-4">
            <h2 class="text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-3">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à (Starter Package)</h2>
            <div class="grid grid-cols-2 lg:grid-cols-4 gap-3">
                <div onclick="selectPackage('normal')" id="pkg-normal" class="pkg-btn p-3 rounded-xl border-slate-200 bg-white shadow-sm active"><div class="text-[10px] font-bold text-slate-400 uppercase">Lv. 0 Start</div><div class="text-xs font-bold text-slate-700 mt-1">Normal Pass</div></div>
                <div onclick="selectPackage('pre0')" id="pkg-pre0" class="pkg-btn p-3 rounded-xl border-slate-200 bg-white shadow-sm"><div class="text-[10px] font-bold text-blue-400 uppercase">Lv. 0 Start</div><div class="text-xs font-bold text-slate-700 mt-1">Premium Pass</div></div>
                <div onclick="selectPackage('pre25')" id="pkg-pre25" class="pkg-btn p-3 rounded-xl border-slate-200 bg-white shadow-sm"><div class="text-[10px] font-bold text-orange-400 uppercase">Lv. 25 Start</div><div class="text-xs font-bold text-slate-700 mt-1">Premium +25</div></div>
                <div onclick="selectPackage('pre100')" id="pkg-pre100" class="pkg-btn p-3 rounded-xl border-slate-200 bg-white shadow-sm"><div class="text-[10px] font-bold text-purple-400 uppercase">Lv. 100 Start</div><div class="text-xs font-bold text-slate-700 mt-1">Premium +100</div></div>
            </div>
        </section>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
            
            <!-- LEFT: PROGRESS & TRACKER -->
            <div class="lg:col-span-4 space-y-6">
                <!-- Progress Dashboard -->
                <div class="game-card p-5 bg-slate-900 text-white border-none shadow-xl">
                    <div class="flex justify-between items-end mb-2">
                        <span class="text-[10px] font-bold text-slate-500 uppercase tracking-widest">Progress Level</span>
                        <span id="bpBadge" class="text-[9px] font-bold px-2 py-0.5 rounded bg-red-600 font-gaming">ROC GGT</span>
                    </div>
                    <div class="flex items-baseline gap-1 mb-4">
                        <span class="text-6xl font-gaming font-bold text-white leading-none" id="currentLevel">0</span>
                        <span class="text-xl font-gaming text-slate-500">/ 2500</span>
                    </div>
                    <div class="w-full bg-slate-800 h-2.5 rounded-full overflow-hidden mb-2 shadow-inner">
                        <div id="progressBar" class="bg-red-500 h-full transition-all duration-500 shadow-[0_0_10px_rgba(239,68,68,0.5)]" style="width: 0%"></div>
                    </div>
                    <div class="flex justify-between items-center pt-3 mt-4 border-t border-white/5">
                        <span class="text-[10px] font-bold text-slate-500 uppercase tracking-widest">Total SV Spent</span>
                        <div class="text-right"><span class="text-xl font-gaming font-bold text-amber-400" id="totalSpent">0</span> <span class="text-[10px] font-bold text-amber-500">SV</span></div>
                    </div>
                </div>

                <!-- Weekly Path -->
                <div class="game-card p-5">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-xs font-bold text-slate-700 uppercase tracking-widest">Weekly Mission Path</h2>
                        <div id="weekRange" class="text-[9px] font-bold text-blue-500 bg-blue-50 px-2 py-0.5 rounded border border-blue-100 uppercase tracking-widest">Wait Start</div>
                    </div>
                    <div class="space-y-6">
                        <div id="vStep1" class="quest-step step-active"><div class="step-bullet">1</div><div class="text-xs font-bold text-slate-700">Amdarais (80 XP)</div><div class="text-[10px] text-slate-400" id="vStatus1">‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ó‡∏≥</div></div>
                        <div id="vStep2" class="quest-step"><div class="step-bullet">2</div><div class="text-xs font-bold text-slate-700">Evil Believer (100 XP)</div><div class="text-[10px] text-slate-400" id="vStatus2">‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¢‡∏π‡πà</div></div>
                        <div id="vStep3" class="quest-step"><div class="step-bullet">3</div><div class="text-xs font-bold text-slate-700">Infinite Tao (120 XP)</div><div class="text-[10px] text-slate-400" id="vStatus3">‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¢‡∏π‡πà</div></div>
                        <div id="vStepZ" class="quest-step"><div class="step-bullet">Z</div><div class="text-xs font-bold text-slate-700">10M Zeny (40 XP)</div><div class="text-[10px] text-slate-400" id="vStatusZ">‡πÄ‡∏õ‡∏¥‡∏î‡∏ï‡∏•‡∏≠‡∏î</div></div>
                    </div>
                </div>
            </div>

            <!-- RIGHT: ENTRY & HISTORY -->
            <div class="lg:col-span-8 space-y-6">
                <!-- Entry Form -->
                <div class="game-card p-5 border-t-4 border-t-amber-400">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="font-bold text-slate-700 flex items-center gap-2">‚úçÔ∏è ‡∏à‡∏î‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</h2>
                        <input type="date" id="logDate" onchange="resetTempState(); updateFormUI()" class="bg-slate-50 border border-slate-200 rounded-lg p-2 text-xs font-bold text-red-600 shadow-sm outline-none">
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <!-- Quests -->
                        <div class="space-y-4">
                            <p class="text-[10px] font-bold text-slate-400 uppercase tracking-widest">‡πÄ‡∏Ñ‡∏ß‡∏™‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô</p>
                            <div class="grid grid-cols-1 gap-2">
                                <label class="flex items-center gap-3 p-3 bg-slate-50 rounded-2xl border border-slate-100 cursor-pointer hover:bg-white hover:border-red-200 transition">
                                    <input type="checkbox" id="qDaily" checked class="w-5 h-5 text-red-600 rounded-lg border-slate-300">
                                    <div class="text-sm font-bold text-slate-700">Daily Quest <span id="dailyXpHint" class="text-[10px] text-slate-400">(30 XP)</span></div>
                                </label>
                                <label class="flex items-center gap-3 p-3 bg-slate-50 rounded-2xl border border-slate-100 cursor-pointer hover:bg-white hover:border-emerald-200 transition">
                                    <input type="checkbox" id="qZenyD" checked class="w-5 h-5 text-emerald-600 rounded-lg border-slate-300">
                                    <div class="text-sm font-bold text-slate-700">Daily Zeny 1M <span class="text-[10px] text-slate-400">(30 XP)</span></div>
                                </label>
                            </div>
                            <div id="weeklyInputArea" class="space-y-2 pt-2 border-t border-slate-100"></div>
                        </div>
                        <!-- Silvervine -->
                        <div class="space-y-4">
                            <p class="text-[10px] font-bold text-slate-400 uppercase tracking-widest">‡∏≠‡∏±‡∏õ‡πÄ‡∏•‡πÄ‡∏ß‡∏•‡∏î‡πâ‡∏ß‡∏¢ Silvervine</p>
                            <div class="bg-slate-50 p-6 rounded-3xl border border-slate-200 shadow-inner">
                                <label class="block text-xs font-bold text-slate-500 mb-4 text-center uppercase tracking-widest">‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ (Lv)</label>
                                <div class="flex items-center gap-4">
                                    <input type="number" id="buyLv" value="0" min="0" class="w-full bg-white border border-slate-200 rounded-2xl text-center text-4xl font-gaming font-bold text-red-600 p-3 shadow-md outline-none">
                                    <div class="text-center min-w-[70px]"><div class="text-2xl font-gaming font-bold text-amber-600 leading-none" id="svCostDisp">0</div><div class="text-[10px] font-bold text-amber-500 uppercase">SV</div></div>
                                </div>
                            </div>
                            <button onclick="saveEntry()" class="w-full btn-roc py-5 rounded-2xl font-bold text-lg uppercase tracking-widest shadow-xl">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° (Save)</button>
                        </div>
                    </div>
                </div>

                <!-- History -->
                <div class="game-card h-full flex flex-col min-h-[400px]">
                    <div class="p-5 border-b border-slate-50 bg-slate-50/30">
                        <h2 class="text-xs font-bold text-slate-500 uppercase tracking-[0.2em]">Diary History Log</h2>
                    </div>
                    <div id="diaryList" class="divide-y divide-slate-100 flex-1 overflow-y-auto custom-scroll"></div>
                </div>
            </div>
        </div>
    </main>

    <script>
        const XP_VAL = { daily: 30, dailyzeny: 30, w1: 80, w2: 100, w3: 120, wzeny: 40 };
        const NORMAL_DAILY_XP = 20;
        const PACKAGES = {
            'normal': { name: 'Normal Pass', startLv: 0, cost: 0, bpItem: '[Normal] Chrono Battle Pass', type: 'normal' },
            'pre0': { name: 'Premium Unlock', startLv: 0, cost: 49, bpItem: '[Premium] Chrono Battle Pass', type: 'premium' },
            'pre25': { name: 'Premium +25 Lv', startLv: 25, cost: 115, bpItem: '[Premium] Chrono Battle Pass', type: 'premium' },
            'pre100': { name: 'Premium +100 Lv', startLv: 100, cost: 295, bpItem: '[Premium] Chrono Battle Pass', type: 'premium' }
        };
        const REWARDS = {
            1: [{n: "Premium Service 10Day Box", q: 1, rare: true}, {n: "Mysterious Medal", q: 10, rare: true}],
            10: [{n: "Treasure Box I", q: 1}],
            23: [{n: "Mysterious Medal", q: 3, rare: true}],
            100: [{n: "Chrono Pass Ticket", q: 1, rare: true}],
            200: [{n: "Costume Cosmic Connection", q: 1, rare: true}, {n: "Treasure Box III", q: 2}],
            300: [{n: "[Not For Sale] Chrono Pass Ticket", q: 1, rare: true}, {n: "Treasure Box I", q: 30}, {n: "Treasure Box III", q: 3}],
            350: [{n: "[Event] Special Enchant Temporal Boots Ticket", q: 1, rare: true}, {n: "Guarantee Weapon 7 Up Pack", q: 1, rare: true}],
            400: [{n: "Guarantee Armor 7 Up Pack", q: 1, rare: true}],
            500: [{n: "Treasure Box II", q: 30}],
            600: [{n: "Guarantee Weapon 9 Up Pack", q: 1, rare: true}],
            700: [{n: "Guarantee Armor 9 Up Pack", q: 1, rare: true}],
            900: [{n: "Treasure Box III", q: 30}],
            1000: [{n: "Treasure Box III", q: 10, rare: true}],
            1500: [{n: "Guarantee Weapon 11 Up Pack", q: 1, rare: true}],
            2000: [{n: "Guarantee Armor 11 Up Pack", q: 1, rare: true}],
            2500: [{n: "Costume Golden Valkyrie Wings", q: 1, rare: true}]
        };

        let entries = JSON.parse(localStorage.getItem('roc_ggt_diary_v8_entries')) || [];
        let config = JSON.parse(localStorage.getItem('roc_ggt_diary_v8_config')) || { package: 'normal' };
        let tempQuests = { w1: false, w2: false, w3: false, wzeny: false };

        const setUI = (id, val) => {
            const el = document.getElementById(id);
            if (el) el.innerText = val;
        };

        document.getElementById('logDate').valueAsDate = new Date();

        function selectPackage(pkgId) {
            config.package = pkgId;
            localStorage.setItem('roc_ggt_diary_v8_config', JSON.stringify(config));
            render();
        }

        function resetTempState() {
            const dateStr = document.getElementById('logDate').value;
            const existing = entries.find(e => e.date === dateStr);
            if (existing) {
                tempQuests = { 
                    w1: existing.quests.includes('w1'), 
                    w2: existing.quests.includes('w2'), 
                    w3: existing.quests.includes('w3'), 
                    wzeny: existing.quests.includes('wzeny') 
                };
            } else { 
                tempQuests = { w1: false, w2: false, w3: false, wzeny: false }; 
            }
        }

        function getWeeklyState(targetDateStr) {
            const past = entries.filter(e => e.date < targetDateStr).sort((a,b) => a.date.localeCompare(b.date));
            let start = null; let prog = { w1: false, w2: 0, w3: 0, wzeny: false };
            past.forEach(e => {
                if (start && (((new Date(e.date)-new Date(start))/86400000)>=7)) { start = null; prog = {w1:false,w2:0,w3:0,wzeny:false}; }
                if (!start && e.quests.some(q => ['w1','w2','w3','wzeny'].includes(q))) start = e.date;
                if (start) {
                    if (e.quests.includes('w1')) prog.w1 = true;
                    if (e.quests.includes('w2')) prog.w2 += 1;
                    if (e.quests.includes('w3')) prog.w3 += 1;
                    if (e.quests.includes('wzeny')) prog.wzeny = true;
                }
            });
            return { currentWeekStart: start, prog };
        }

        function updateFormUI() {
            const pkg = PACKAGES[config.package];
            const { currentWeekStart, prog } = getWeeklyState(document.getElementById('logDate').value);
            
            let canDoW1 = !prog.w1;
            let canDoW2 = (prog.w1 || tempQuests.w1) && (prog.w2 < 2);
            let totalEB = prog.w2 + (tempQuests.w2 ? 1 : 0);
            let canDoW3 = (prog.w1 || tempQuests.w1) && totalEB >= 2 && prog.w3 < 3;
            let canDoZeny = !prog.wzeny;

            let html = "";
            html += createQuestCard('w1', 'Amdarais (1/1)', canDoW1, tempQuests.w1, 'Step 1');
            html += createQuestCard('w2', `Evil Believer (${prog.w2}/2)`, canDoW2, tempQuests.w2, 'Step 2 (1/day)');
            html += createQuestCard('w3', `Infinite Tao (${prog.w3}/3)`, canDoW3, tempQuests.w3, 'Step 3 (1/day)');
            html += createQuestCard('wzeny', 'Send 10M Zeny', canDoZeny, tempQuests.wzeny, 'Weekly Once');
            
            const weeklyInputArea = document.getElementById('weeklyInputArea');
            if (weeklyInputArea) weeklyInputArea.innerHTML = html;

            document.querySelectorAll('.pkg-btn').forEach(el => el.classList.remove('active'));
            const pkgBtn = document.getElementById(`pkg-${config.package}`);
            if(pkgBtn) pkgBtn.classList.add('active');

            const dailyXpHint = document.getElementById('dailyXpHint');
            if(dailyXpHint) dailyXpHint.innerText = pkg.type === 'premium' ? '(30 XP)' : '(20 XP)';
            
            const weekRange = document.getElementById('weekRange');
            if(weekRange) weekRange.innerText = currentWeekStart ? `Week Start: ${new Date(currentWeekStart).toLocaleDateString('th-TH')}` : "Not Started";
            
            updateVisualSteps(prog);
        }

        function handleCheckChange(id) { 
            tempQuests[id] = document.getElementById(id).checked; 
            updateFormUI(); 
        }

        function createQuestCard(id, label, enabled, checked, hint) {
            const finished = !enabled && !checked && (id==='w1' || id==='wzeny' || (id==='w2'&&label.includes('2/2')) || (id==='w3'&&label.includes('3/3')));
            return `<label class="flex items-center gap-3 p-3 bg-white rounded-2xl border border-slate-100 shadow-sm transition ${enabled ? 'cursor-pointer hover:border-red-300' : 'opacity-40 grayscale cursor-not-allowed'}">
                <input type="checkbox" id="${id}" ${checked?'checked':''} ${enabled?`onchange="handleCheckChange('${id}')"`:'disabled'} class="w-5 h-5 text-red-600 rounded-lg">
                <div class="flex-1"><div class="text-sm font-bold text-slate-700">${label}</div><div class="text-[9px] font-bold ${finished?'text-green-500':'text-slate-400'} uppercase">${finished?'Completed':hint}</div></div>
            </label>`;
        }

        function updateVisualSteps(prog) {
            const set = (id, sid, state, c=0, m=1) => {
                const e = document.getElementById(id); const s = document.getElementById(sid);
                if (e && s) { 
                    e.className = 'quest-step ' + (state==='done' ? 'step-done' : state==='active' ? 'step-active' : 'opacity-30'); 
                    s.innerText = state==='done'?'Finished':state==='active'?(m>1?`${c}/${m}`:'Open'):'Locked'; 
                }
            };
            set('vStep1', 'vStatus1', prog.w1?'done':'active');
            if(prog.w1) set('vStep2', 'vStatus2', prog.w2>=2?'done':'active', prog.w2, 2); else set('vStep2', 'vStatus2', 'locked');
            if(prog.w2>=2) set('vStep3', 'vStatus3', prog.w3>=3?'done':'active', prog.w3, 3); else set('vStep3', 'vStatus3', 'locked');
            set('vStepZ', 'vStatusZ', prog.wzeny?'done':'active');
        }

        function saveEntry() {
            const date = document.getElementById('logDate').value;
            const quests = [];
            if(document.getElementById('qDaily')?.checked) quests.push('daily');
            if(document.getElementById('qZenyD')?.checked) quests.push('dailyzeny');
            Object.keys(tempQuests).forEach(key => { if(tempQuests[key]) quests.push(key); });
            const buyLv = parseInt(document.getElementById('buyLv').value) || 0;
            const idx = entries.findIndex(e => e.date === date);
            if(idx > -1) entries[idx] = { date, quests, buyLv }; else entries.push({ date, quests, buyLv });
            localStorage.setItem('roc_ggt_diary_v8_entries', JSON.stringify(entries));
            document.getElementById('buyLv').value = 0; render();
        }

        function render() {
            entries.sort((a,b) => a.date.localeCompare(b.date));
            const pkg = PACKAGES[config.package];
            let currentLv = pkg.startLv; let currentXP = 0; let currentSV = pkg.cost;
            let wStart = null; let wProg = { w1:false, w2:0, w3:0, wzeny:false };
            const logs = [];

            entries.forEach((e, idx) => {
                const startLv = currentLv;
                if(wStart && (((new Date(e.date)-new Date(wStart))/86400000)>=7)) { wStart=null; wProg={w1:false,w2:0,w3:0,wzeny:false}; }
                currentLv += e.buyLv; currentSV += (e.buyLv * 3);
                e.quests.forEach(q => {
                    if(q==='daily') currentXP += (pkg.type==='premium'?30:NORMAL_DAILY_XP);
                    if(q==='dailyzeny') currentXP += 30;
                    if(['w1','w2','w3','wzeny'].includes(q) && !wStart) wStart = e.date;
                    if(q==='w1'&&!wProg.w1) { wProg.w1=true; currentXP+=XP_VAL.w1; }
                    if(q==='w2'&&wProg.w2<2) { wProg.w2+=1; if(wProg.w2===2) currentXP+=XP_VAL.w2; }
                    if(q==='w3'&&wProg.w3<3) { wProg.w3+=1; if(wProg.w3===3) currentXP+=XP_VAL.w3; }
                    if(q==='wzeny'&&!wProg.wzeny) { wProg.wzeny=true; currentXP+=XP_VAL.wzeny; }
                });
                currentLv += Math.floor(currentXP / 10); currentXP %= 10;
                const gained = []; if(idx===0) gained.push({n: pkg.bpItem, q:1, rare:true});
                for(let l=startLv+1; l<=currentLv; l++) {
                    if(REWARDS[l]) REWARDS[l].forEach(item => gained.push({...item}));
                    if(l>100 && pkg.type==='premium') { if(l%10===0) gained.push({n:"Treasure Box I", q:1}); if(l%20===0) gained.push({n:"Treasure Box II", q:1}); if(l%50===0) gained.push({n:"Treasure Box III", q:1}); }
                }
                logs.push({ ...e, endLv: currentLv, gained });
            });

            setUI('currentLevel', currentLv);
            setUI('totalSpent', currentSV.toLocaleString());
            const progressBar = document.getElementById('progressBar');
            if(progressBar) progressBar.style.width = Math.min(100, (currentLv/2500)*100) + '%';
            
            const historyHTML = logs.reverse().map(e => `
                <div class="p-5 hover:bg-slate-50 transition flex gap-6">
                    <div class="flex-none w-16 text-center border-r border-slate-100 pr-2">
                        <div class="text-[9px] font-bold text-slate-400 uppercase leading-none">${new Date(e.date).toLocaleDateString('th-TH',{day:'2-digit',month:'short'})}</div>
                        <div class="text-2xl font-gaming font-bold text-red-600 mt-1">${e.endLv}</div>
                        <div class="text-[8px] font-bold text-slate-300">LEVEL</div>
                    </div>
                    <div class="flex-1 space-y-3">
                        <div class="flex gap-2 flex-wrap">${e.quests.map(q => `<span class="text-[8px] font-bold bg-slate-100 text-slate-600 px-1.5 py-0.5 rounded border border-slate-200 uppercase">${q}</span>`).join('')}</div>
                        <div class="flex flex-wrap gap-1.5">${e.gained.length?e.gained.map(i=>`<span class="bg-white border border-red-100 text-red-700 text-[9px] px-2 py-0.5 rounded shadow-sm font-bold flex items-center gap-1">üîπ ${i.n} x${i.q}</span>`).join(''):'<span class="text-[9px] text-slate-300 italic">No New Items</span>'}</div>
                    </div>
                </div>`).join('');
            const diaryList = document.getElementById('diaryList');
            if(diaryList) diaryList.innerHTML = historyHTML || '<div class="p-20 text-center text-slate-300 text-sm font-bold tracking-widest">LOG IS EMPTY</div>';
            resetTempState(); updateFormUI();
        }

        function resetData() { if(confirm('Erase all diary records?')){ entries = []; localStorage.removeItem('roc_ggt_diary_v8_entries'); render(); }}
        document.getElementById('buyLv')?.addEventListener('input', (e) => { const disp = document.getElementById('svCostDisp'); if(disp) disp.innerText = (parseInt(e.target.value || 0) * 3).toLocaleString(); });
        render();
    </script>
</body>
</html>
